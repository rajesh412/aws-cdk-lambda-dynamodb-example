"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const appscaling = require("@aws-cdk/aws-applicationautoscaling");
/**
 * A scalable table attribute
 */
class ScalableTableAttribute extends appscaling.BaseScalableAttribute {
    /**
     * Scale out or in based on time
     */
    scaleOnSchedule(id, action) {
        super.doScaleOnSchedule(id, action);
    }
    /**
     * Scale out or in to keep utilization at a given level
     */
    scaleOnUtilization(props) {
        if (props.targetUtilizationPercent < 10 || props.targetUtilizationPercent > 90) {
            // tslint:disable-next-line:max-line-length
            throw new RangeError(`targetUtilizationPercent for DynamoDB scaling must be between 10 and 90 percent, got: ${props.targetUtilizationPercent}`);
        }
        const predefinedMetric = this.props.dimension.indexOf('ReadCapacity') === -1
            ? appscaling.PredefinedMetric.DynamoDBWriteCapacityUtilization
            : appscaling.PredefinedMetric.DynamoDBReadCapacityUtilization;
        super.doScaleToTrackMetric('Tracking', {
            policyName: props.policyName,
            disableScaleIn: props.disableScaleIn,
            scaleInCooldownSec: props.scaleInCooldownSec,
            scaleOutCooldownSec: props.scaleOutCooldownSec,
            targetValue: props.targetUtilizationPercent,
            predefinedMetric,
        });
    }
}
exports.ScalableTableAttribute = ScalableTableAttribute;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NhbGFibGUtdGFibGUtYXR0cmlidXRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsic2NhbGFibGUtdGFibGUtYXR0cmlidXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsa0VBQW1FO0FBR25FOztHQUVHO0FBQ0gsTUFBYSxzQkFBdUIsU0FBUSxVQUFVLENBQUMscUJBQXFCO0lBQzFFOztPQUVHO0lBQ0ksZUFBZSxDQUFDLEVBQVUsRUFBRSxNQUFrQztRQUNuRSxLQUFLLENBQUMsaUJBQWlCLENBQUMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ3RDLENBQUM7SUFFRDs7T0FFRztJQUNJLGtCQUFrQixDQUFDLEtBQThCO1FBQ3RELElBQUksS0FBSyxDQUFDLHdCQUF3QixHQUFHLEVBQUUsSUFBSSxLQUFLLENBQUMsd0JBQXdCLEdBQUcsRUFBRSxFQUFFO1lBQzlFLDJDQUEyQztZQUMzQyxNQUFNLElBQUksVUFBVSxDQUFDLHlGQUF5RixLQUFLLENBQUMsd0JBQXdCLEVBQUUsQ0FBQyxDQUFDO1NBQ2pKO1FBQ0QsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3hFLENBQUMsQ0FBQyxVQUFVLENBQUMsZ0JBQWdCLENBQUMsZ0NBQWdDO1lBQzlELENBQUMsQ0FBQyxVQUFVLENBQUMsZ0JBQWdCLENBQUMsK0JBQStCLENBQUM7UUFFbEUsS0FBSyxDQUFDLG9CQUFvQixDQUFDLFVBQVUsRUFBRTtZQUNyQyxVQUFVLEVBQUUsS0FBSyxDQUFDLFVBQVU7WUFDNUIsY0FBYyxFQUFFLEtBQUssQ0FBQyxjQUFjO1lBQ3BDLGtCQUFrQixFQUFFLEtBQUssQ0FBQyxrQkFBa0I7WUFDNUMsbUJBQW1CLEVBQUUsS0FBSyxDQUFDLG1CQUFtQjtZQUM5QyxXQUFXLEVBQUUsS0FBSyxDQUFDLHdCQUF3QjtZQUMzQyxnQkFBZ0I7U0FDakIsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGO0FBN0JELHdEQTZCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBhcHBzY2FsaW5nID0gcmVxdWlyZSgnQGF3cy1jZGsvYXdzLWFwcGxpY2F0aW9uYXV0b3NjYWxpbmcnKTtcbmltcG9ydCB7IFV0aWxpemF0aW9uU2NhbGluZ1Byb3BzIH0gZnJvbSAnLi9zY2FsYWJsZS1hdHRyaWJ1dGUtYXBpJztcblxuLyoqXG4gKiBBIHNjYWxhYmxlIHRhYmxlIGF0dHJpYnV0ZVxuICovXG5leHBvcnQgY2xhc3MgU2NhbGFibGVUYWJsZUF0dHJpYnV0ZSBleHRlbmRzIGFwcHNjYWxpbmcuQmFzZVNjYWxhYmxlQXR0cmlidXRlIHtcbiAgLyoqXG4gICAqIFNjYWxlIG91dCBvciBpbiBiYXNlZCBvbiB0aW1lXG4gICAqL1xuICBwdWJsaWMgc2NhbGVPblNjaGVkdWxlKGlkOiBzdHJpbmcsIGFjdGlvbjogYXBwc2NhbGluZy5TY2FsaW5nU2NoZWR1bGUpIHtcbiAgICBzdXBlci5kb1NjYWxlT25TY2hlZHVsZShpZCwgYWN0aW9uKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTY2FsZSBvdXQgb3IgaW4gdG8ga2VlcCB1dGlsaXphdGlvbiBhdCBhIGdpdmVuIGxldmVsXG4gICAqL1xuICBwdWJsaWMgc2NhbGVPblV0aWxpemF0aW9uKHByb3BzOiBVdGlsaXphdGlvblNjYWxpbmdQcm9wcykge1xuICAgIGlmIChwcm9wcy50YXJnZXRVdGlsaXphdGlvblBlcmNlbnQgPCAxMCB8fCBwcm9wcy50YXJnZXRVdGlsaXphdGlvblBlcmNlbnQgPiA5MCkge1xuICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aFxuICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoYHRhcmdldFV0aWxpemF0aW9uUGVyY2VudCBmb3IgRHluYW1vREIgc2NhbGluZyBtdXN0IGJlIGJldHdlZW4gMTAgYW5kIDkwIHBlcmNlbnQsIGdvdDogJHtwcm9wcy50YXJnZXRVdGlsaXphdGlvblBlcmNlbnR9YCk7XG4gICAgfVxuICAgIGNvbnN0IHByZWRlZmluZWRNZXRyaWMgPSB0aGlzLnByb3BzLmRpbWVuc2lvbi5pbmRleE9mKCdSZWFkQ2FwYWNpdHknKSA9PT0gLTFcbiAgICAgICAgPyBhcHBzY2FsaW5nLlByZWRlZmluZWRNZXRyaWMuRHluYW1vREJXcml0ZUNhcGFjaXR5VXRpbGl6YXRpb25cbiAgICAgICAgOiBhcHBzY2FsaW5nLlByZWRlZmluZWRNZXRyaWMuRHluYW1vREJSZWFkQ2FwYWNpdHlVdGlsaXphdGlvbjtcblxuICAgIHN1cGVyLmRvU2NhbGVUb1RyYWNrTWV0cmljKCdUcmFja2luZycsIHtcbiAgICAgIHBvbGljeU5hbWU6IHByb3BzLnBvbGljeU5hbWUsXG4gICAgICBkaXNhYmxlU2NhbGVJbjogcHJvcHMuZGlzYWJsZVNjYWxlSW4sXG4gICAgICBzY2FsZUluQ29vbGRvd25TZWM6IHByb3BzLnNjYWxlSW5Db29sZG93blNlYyxcbiAgICAgIHNjYWxlT3V0Q29vbGRvd25TZWM6IHByb3BzLnNjYWxlT3V0Q29vbGRvd25TZWMsXG4gICAgICB0YXJnZXRWYWx1ZTogcHJvcHMudGFyZ2V0VXRpbGl6YXRpb25QZXJjZW50LFxuICAgICAgcHJlZGVmaW5lZE1ldHJpYyxcbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIFByb3BlcnRpZXMgZm9yIGVuYWJsaW5nIER5bmFtb0RCIGNhcGFjaXR5IHNjYWxpbmdcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBFbmFibGVTY2FsaW5nUHJvcHMge1xuICAvKipcbiAgICogTWluaW11bSBjYXBhY2l0eSB0byBzY2FsZSB0b1xuICAgKi9cbiAgbWluQ2FwYWNpdHk6IG51bWJlcjtcblxuICAvKipcbiAgICogTWF4aW11bSBjYXBhY2l0eSB0byBzY2FsZSB0b1xuICAgKi9cbiAgbWF4Q2FwYWNpdHk6IG51bWJlcjtcbn1cbiJdfQ==