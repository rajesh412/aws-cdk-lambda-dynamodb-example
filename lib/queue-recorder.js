"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cdk = require("@aws-cdk/cdk");
const lambda = require("@aws-cdk/aws-lambda");
const event_sources = require("@aws-cdk/aws-lambda-event-sources");
const dynamodb = require("@aws-cdk/aws-dynamodb");
class QueueRecorder extends cdk.Construct {
    constructor(parent, id, props) {
        super(parent, id);
        const fn = new lambda.Function(this, 'HelloFunction', {
            runtime: lambda.Runtime.NodeJS810,
            code: lambda.Code.asset('lambda'),
            handler: 'index.handler'
        });
        fn.addEventSource(new event_sources.SqsEventSource(props.inputQueue));
        const table = new dynamodb.Table(this, 'QueueRecorderTable2', {
            partitionKey: { name: 'id', type: dynamodb.AttributeType.String },
            readCapacity: 1,
            writeCapacity: 1
        });
        fn.addEnvironment('TABLE_NAME', table.tableName);
        table.grantReadWriteData(fn.role);
    }
}
exports.QueueRecorder = QueueRecorder;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVldWUtcmVjb3JkZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJxdWV1ZS1yZWNvcmRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG9DQUFxQztBQUNyQyw4Q0FBK0M7QUFDL0MsbUVBQW9FO0FBRXBFLGtEQUFtRDtBQU9uRCxNQUFhLGFBQWMsU0FBUSxHQUFHLENBQUMsU0FBUztJQUU1QyxZQUFZLE1BQXFCLEVBQUUsRUFBVSxFQUFFLEtBQXdCO1FBRW5FLEtBQUssQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDbEIsTUFBTSxFQUFFLEdBQUcsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksRUFBQyxlQUFlLEVBQUM7WUFDaEQsT0FBTyxFQUFFLE1BQU0sQ0FBQyxPQUFPLENBQUMsU0FBUztZQUNqQyxJQUFJLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDO1lBQ2pDLE9BQU8sRUFBRSxlQUFlO1NBQzNCLENBQUMsQ0FBQztRQUVQLEVBQUUsQ0FBQyxjQUFjLENBQUMsSUFBSSxhQUFhLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO1FBRWxFLE1BQU0sS0FBSyxHQUFFLElBQUksUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUscUJBQXFCLEVBQUU7WUFDN0QsWUFBWSxFQUFFLEVBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsUUFBUSxDQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUM7WUFDL0QsWUFBWSxFQUFFLENBQUM7WUFDZixhQUFhLEVBQUUsQ0FBQztTQUNmLENBQUMsQ0FBQztRQUVQLEVBQUUsQ0FBQyxjQUFjLENBQUMsWUFBWSxFQUFFLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNqRCxLQUFLLENBQUMsa0JBQWtCLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBRWxDLENBQUM7Q0FFSjtBQXhCRCxzQ0F3QkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY2RrID0gcmVxdWlyZSgnQGF3cy1jZGsvY2RrJyk7XG5pbXBvcnQgbGFtYmRhID0gcmVxdWlyZSgnQGF3cy1jZGsvYXdzLWxhbWJkYScpO1xuaW1wb3J0IGV2ZW50X3NvdXJjZXMgPSByZXF1aXJlKCdAYXdzLWNkay9hd3MtbGFtYmRhLWV2ZW50LXNvdXJjZXMnKTtcbmltcG9ydCBzcXMgPSByZXF1aXJlKCdAYXdzLWNkay9hd3Mtc3FzJyk7XG5pbXBvcnQgZHluYW1vZGIgPSByZXF1aXJlKCdAYXdzLWNkay9hd3MtZHluYW1vZGInKTtcblxuXG5leHBvcnQgaW50ZXJmYWNlIFF1ZXVlUmVjb2RlclByb3BzXG57XG4gICAgaW5wdXRRdWV1ZTogc3FzLlF1ZXVlXG59XG5leHBvcnQgY2xhc3MgUXVldWVSZWNvcmRlciBleHRlbmRzIGNkay5Db25zdHJ1Y3RcbntcbiAgICBjb25zdHJ1Y3RvcihwYXJlbnQ6IGNkay5Db25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzOiBRdWV1ZVJlY29kZXJQcm9wcylcbiAgICB7XG4gICAgICAgIHN1cGVyKHBhcmVudCwgaWQpO1xuICAgICAgICBjb25zdCBmbiA9IG5ldyBsYW1iZGEuRnVuY3Rpb24odGhpcywnSGVsbG9GdW5jdGlvbicse1xuICAgICAgICAgICAgcnVudGltZTogbGFtYmRhLlJ1bnRpbWUuTm9kZUpTODEwLFxuICAgICAgICAgICAgY29kZTogbGFtYmRhLkNvZGUuYXNzZXQoJ2xhbWJkYScpLFxuICAgICAgICAgICAgaGFuZGxlcjogJ2luZGV4LmhhbmRsZXInXG4gICAgICAgIH0pO1xuXG4gICAgZm4uYWRkRXZlbnRTb3VyY2UobmV3IGV2ZW50X3NvdXJjZXMuU3FzRXZlbnRTb3VyY2UocHJvcHMuaW5wdXRRdWV1ZSkpO1xuXG4gICAgICAgIGNvbnN0IHRhYmxlID1uZXcgZHluYW1vZGIuVGFibGUodGhpcywgJ1F1ZXVlUmVjb3JkZXJUYWJsZTInLCB7XG4gICAgICAgIHBhcnRpdGlvbktleToge25hbWU6ICdpZCcsIHR5cGU6IGR5bmFtb2RiLkF0dHJpYnV0ZVR5cGUuU3RyaW5nfSxcbiAgICAgICAgcmVhZENhcGFjaXR5OiAxLFxuICAgICAgICB3cml0ZUNhcGFjaXR5OiAxXG4gICAgICAgIH0pO1xuXG4gICAgZm4uYWRkRW52aXJvbm1lbnQoJ1RBQkxFX05BTUUnLCB0YWJsZS50YWJsZU5hbWUpO1xuICAgIHRhYmxlLmdyYW50UmVhZFdyaXRlRGF0YShmbi5yb2xlKTtcbiAgICBcbiAgICB9XG5cbn0iXX0=